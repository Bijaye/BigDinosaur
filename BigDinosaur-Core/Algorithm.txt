Here goes the algorithm of control flow 